{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/blog/2018-09-07-sharpのビルドに失敗する/","result":{"data":{"markdownRemark":{"excerpt":"概要 Windows 環境において、gatsby を node v10.9.0 でインストールしようとすると、関連でエラーが出て失敗するようになりました。はの依存先として使用されています。 通常 sharp は、時に OS…","html":"<h2>概要</h2>\n<p>Windows 環境において、gatsby を node v10.9.0 でインストールしようとすると、<code class=\"language-text\">sharp</code>関連でエラーが出て失敗するようになりました。<code class=\"language-text\">sharp</code>は<code class=\"language-text\">gatsby-remark-images</code>の依存先として使用されています。</p>\n<p>通常 sharp は、<code class=\"language-text\">npm install</code>時に OS に適合したプレビルドのバイナリを取得してくるのですが、Node v10.9.0 の Windows 用バイナリはまだ存在しないようです。</p>\n<p>バイナリがない場合は、<a href=\"http://sharp.pixelplumbing.com/en/stable/install/#building-from-source\">ソースからビルドしようとします</a>。ここで、必要なビルドツールが存在しないため、コケているようです。</p>\n<h2>解決方法</h2>\n<p><code class=\"language-text\">windows-build-tools</code>という便利なパッケージを使えば一発で解決できるそうなのですが、自分の環境ではうまく動きませんでした。結局、下記の作業で解決しました。</p>\n<ol>\n<li><a href=\"https://visualstudio.microsoft.com/ja/downloads/\">こちらのページ</a>から、\nTools for Visual Studio 2017 => Build Tools for Visual Studio 2017\nをダウンロードする。</li>\n<li>ダウンロードしたファイルを開き、<strong>Windows 10 SDK</strong> と <strong>Windows 8.1 SDK</strong>をインストールする。\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 500px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/5a32dcd46acda0582f5e33f9e1368379/10e70/20180907.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.75632421270005%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABqUlEQVQoz32T626bQBCFef+niiJVSW1j7jT9YVMlrS0W7wUM5mLD6cziRI2tdMURsys4+83sjuN5PqIoQRTGpAhhMCtJkqtSpGmKmOI4nmXXr3FKcRTFCMMQi+USDk+01vizz5H9zvG2lxDFAVJK1HUNYwyUUmia5rNOJ1ILXTWomxP6vsPr6xucLPtlP1BK4zIB9NyNafq8Oo0TDrqCOCgIU6MbznZdSgVns9miqioURfFfI46tKB6GgYyITht07Qnn82woRAFnu93ieDzSRFjSruvsD+9mH0ZX8ej7AeN4nwtDkWFmDblmXEsWm/5rdks8UIqXy3j3jTXMiLCuj3ZSliXt3tPu4x3ZLeGXhvHPDEIT4aGwlON7qvh6MCFvekte0O1wopcNVNkQnUHbtjPdVeONmIrfc5057cuHGCHPBZzA98hZYLfb0UKOnA4np9PaCwlJV8mYua5KSRvzjaip5lx3vqeclaBUtSnB5+E8PDxitXLx9PQM13WxctdYrDw8Lz0sXR++H8DzfazXHvwgoI7hznlBkv6gTkltt/hRiu9ujMdvC/wFuLhED/iw1eMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"選択画面\"\n        title=\"選択画面\"\n        src=\"/static/5a32dcd46acda0582f5e33f9e1368379/d19c0/20180907.png\"\n        srcset=\"/static/5a32dcd46acda0582f5e33f9e1368379/6b181/20180907.png 125w,\n/static/5a32dcd46acda0582f5e33f9e1368379/5039d/20180907.png 250w,\n/static/5a32dcd46acda0582f5e33f9e1368379/d19c0/20180907.png 500w,\n/static/5a32dcd46acda0582f5e33f9e1368379/35c67/20180907.png 750w,\n/static/5a32dcd46acda0582f5e33f9e1368379/e11df/20180907.png 1000w,\n/static/5a32dcd46acda0582f5e33f9e1368379/10e70/20180907.png 1937w\"\n        sizes=\"(max-width: 500px) 100vw, 500px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></li>\n<li>Python 2.7 をインストールしてパスを通しておく。</li>\n<li>\n<p>下記コマンドを実行する。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> config <span class=\"token builtin class-name\">set</span> python python2.7\n<span class=\"token function\">npm</span> config <span class=\"token builtin class-name\">set</span> msvs_version <span class=\"token number\">2015</span> --global</code></pre></div>\n</li>\n</ol>\n<h2>参考</h2>\n<p><a href=\"https://github.com/nodejs/node-gyp/issues/629#issuecomment-153196245\">こちらのポスト</a></p>","fields":{"slug":"/2018-09-07-sharpのビルドに失敗する/"},"frontmatter":{"title":"sharpのビルドに失敗する","summary":"gatsbyをnode v10.9.0でインストールしようとすると、`sharp`関連でエラーが出て失敗する件の解決方法。","date":"2018-09-06T23:26:47.761Z","dateModified":"2018-09-06T23:26:47.761Z","thumbnail":"/blogImages/20180907.png"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2018-09-07-sharpのビルドに失敗する/","modifiedDate":"2018-09-06T23:26:47.761Z"}}}